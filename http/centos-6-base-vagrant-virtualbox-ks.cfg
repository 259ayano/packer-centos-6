install
text
skipx
cdrom

lang en_GB.UTF-8
keyboard uk
timezone Etc/UTC --utc

rootpw vagrant

authconfig --enableshadow --passalgo=sha512
bootloader --location=mbr
firewall --enabled --service=ssh
network --onboot=yes --device=eth0 --bootproto=dhcp --noipv6 --hostname=localhost.localdomain
selinux --permissive

# Partitions
clearpart --all --initlabel
zerombr
part /boot --size=250 --fstype=ext4
part pv.01 --size=1 --grow

# Logical Volumes
# 32768 Physical Extents = 16MiB @ 512 bytes/sector.
volgroup vg_root --pesize=32768 pv.01
logvol swap --vgname=vg_root --size=512 --name=lv_swap --fstype=swap --grow --maxsize=4096
logvol / --vgname=vg_root --size=1024 --name=lv_root --fstype=ext4 --grow

reboot

%packages --instLangs=en_GB.UTF-8 --nobase --nocore --ignoremissing --excludedocs
@core --nodefaults
nfs-utils

# Core Default Packages to exclude
-aic94xx-firmware
-atmel-firmware
-b43-openfwwf
-bfa-firmware
-efibootmgr
# -grub
-ipw2100-firmware
-ipw2200-firmware
-ivtv-firmware
-iwl100-firmware
-iwl1000-firmware
-iwl3945-firmware
-iwl4965-firmware
-iwl5000-firmware
-iwl5150-firmware
-iwl6000-firmware
-iwl6000g2a-firmware
-iwl6050-firmware
# -kernel-firmware
-kexec-tools
-libertas-usb8388-firmware
-netxen-firmware
# -postfix
-ql2100-firmware
-ql2200-firmware
-ql23xx-firmware
-ql2400-firmware
-ql2500-firmware
-rdma
-rt61pci-firmware
-rt73usb-firmware
-xorg-x11-drv-ati-firmware
-zd1211-firmware
%end

%post
# Reduce the size of the initramfs image
/sbin/dracut -f -H

# ------------------------------------------------------------------------------
# Reduce Locale resources
# ------------------------------------------------------------------------------

# Remove all but en_GB and en_US from the locale archive and rebuild.
/usr/bin/localedef --list-archive | \
  /bin/awk '!/^en_(GB|US)(.iso88591|.utf8)?$/' | \
  /usr/bin/xargs /usr/bin/localedef --delete-from-archive
/bin/mv /usr/lib/locale/locale-archive /usr/lib/locale/locale-archive.tmpl
/usr/sbin/build-locale-archive
/usr/bin/truncate -s 0 /usr/lib/locale/locale-archive.tmpl

# Remove all files from subdirectories of /usr/share/locale except the contents  
# of /usr/share/locale/en_GB or /usr/share/locale/en_@* directories.
/bin/find /usr/share/locale -mindepth 1 -maxdepth 1 -type d | \
  /bin/awk '!/^\/usr\/share\/locale\/en(_(GB|US)|@.*)?$/' | \
  /usr/bin/xargs -I {} /bin/find {} -type f -delete

# Delete all except UTF-8.gz from character map files
# /bin/find /usr/share/i18n/charmaps -type f -not -name UTF-8.gz -delete

# Remove locale files for unused languages.
/bin/find /usr/share/i18n/locales -type f | \
  /bin/awk '!/\/en(_(GB|US))?(.(utf|UTF-)8)?$/' | \
  /bin/awk '/[a-z][a-z]([a-z])?_[A-Z][A-Z](@.+)?/' \
  /usr/bin/xargs -I {} /bin/find {} -type f -delete

# Uncomment to unset system locale
# /usr/bin/truncate -s 0 /etc/sysconfig/i18n

# ------------------------------------------------------------------------------
# Remove desktop wallpapers and backgrounds
# ------------------------------------------------------------------------------
/bin/find /usr/share/{backgrounds,kde4,wallpapers} \
  -type f -regextype posix-extended -regex '.*\.(jpg|png)$' -delete

%end